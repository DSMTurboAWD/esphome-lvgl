Inspired by the work of agillis. Many thanks for the starting point.
https://github.com/agillis/esphome-configs/tree/main
